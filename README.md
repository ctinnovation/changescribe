| ![changelogger logo](./changelogger.jpeg) |
| :---------------------------------------: |
|     *changelogger 𐫴 generated by AI*      |

# @ctinnovation/changelogger

A CHANGELOG.md utility generator. Provide a folder `/unreleased` with a Markdown file for each of your completed tasks: each file should be named with the task or ticket code related.

Run this utility in order to generate or update a CHANGELOG file merging each file in a new release or explore a range of versions included in the CHANGELOG. You must specify the [semver version](https://semver.org/lang/it/) code for the next release to be generated.

- [Installation](#installation)
- [Commands and usage](#commands-and-usage)
  - [Generate (default)](#generate-default)
  - [Explore](#explore)
  - [Init](#init)
- [Task file format](#task-file-format)
  - [Example](#example)

## Installation

This tool needs [NodeJS](https://nodejs.org/en) and it is tested with node version `16 ~ 20.X`.

```bash
npm install -g @ctinnovation/changelogger
changelogger --help
```

## Commands and usage

### Generate (default)

In your `unreleased` folder you have a `PR-120.md` file with this content:

```markdown
## Added 
- I added this

## Changed

- I've changed this
- And also this

## Fixed

- I fixed this
- But also this!
```

Running this utility:

```bash
changelogger --taskUrlTemplate http://mydomain.atlassian.net/browse/{taskCode} --targetVersion 1.0.0
```

or 

```bash
changelogger generate --taskUrlTemplate http://mydomain.atlassian.net/browse/{taskCode} --targetVersion 1.0.0
```

or (use package.json version as target version)

```bash
changelogger generate --taskUrlTemplate http://mydomain.atlassian.net/browse/{taskCode} -p
```

You'll have a CHANGELOG.md like this:

---
> # Changelog
> 
> All notable changes to this project will be documented in this file.
> 
> [![CHANGELOG FORMAT](https://img.shields.io/badge/Format-keepachangelog-orange.svg)](https://keepachangelog.com/en/1.0.0/)
> [![VERSIONING](https://img.shields.io/badge/Versioning-semver-red.svg)](https://semver.org/spec/v2.0.0.html)
> 
> - [[1.0.0] - 2023-09-26](#100---2021-07-05)
> 
> ## [1.0.0] - 2023-09-26
> 
> [![TASK](https://img.shields.io/badge/TASK-BC%20120-default.svg)](https://jira.com/browse/PR-120)
>
> #### Added
> - I added this
> #### Changed
> 
> - I've changed this
> - And also this
> 
> #### Fixed
> 
> - I fixed this
> - But also this!
---

Feel free to customize your template by modifying the templates inside `templates` folder.

| Argument                 | Description                                                        | Value                                          |
| ------------------------ | ------------------------------------------------------------------ | ---------------------------------------------- |
| --version                | Show version number                                                | [boolean]                                      |
| -t, --targetVersion      | Specific target version.                                           | [string]                                       |
| -p, --fromPackageJson    | Retrieve target version from pkg.json (excludes `--targetVersion`) | [boolean] [default: false]                     |
| -o, --output             | Ouput CHANGELOG file                                               | [string] [default: process.pwd()/CHANGELOG.md] |
| -i, --input              | Input folder for compiling the changelog                           | [string] [default: process.pwd()/unreleased]   |
| --includeCommits         | Include branch commits in new release                              | [boolean] [default: false]                     |
| --excludeTaskList        | Exclude tasks list after release title                             | [boolean] [default: false]                     |
| --createOutputIfNotFound | Create a new output file if not found                              | [boolean] [default: true]                      |
| -u, --taskUrlTemplate    | Associated task URL                                                | [string] [required]                            |
| --help                   | Show help                                                          | [boolean]                                      |


### Explore

You can explore a range of versions contained in a `CHANGELOG.md` file generated with this tool:

```bash
changelogger explore --range 1.2.1
```

This command will exctract you a range of versions, in this case from 1.2.1 to the latest.
You'll get a console logs similar to the following:

---
> # `packageName` changelog from 1.2.1 to 1.3.1 (1.2.1~1.3.1)
> 
>All notable changes to this project from version 1.2.1 to 1.3.1.
>
>CHANGELOG FORMAT https://keepachangelog.com/en/1.0.0/
> 
>VERSIONING https://semver.org/spec/v2.0.0.html
>
>## 1.3.1
>https://jira.com/browse/{taskCode}
>
>### Added
>
>- I added this
>## 1.2.5
>https://jira.com/browse/{taskCode}
>
>### Added
>
>- I changed this
>### Fixed
>- I fixed this
>
>## 1.2.1
>https://jira.com/browse/{taskCode}
>
>### Added
>
>- I changed this
>### Fixed
>- I fixed this
>
---

| Argument     | Description                                      | Value                                         |
| ------------ | ------------------------------------------------ | --------------------------------------------- |
| --version    | Show version number                              | [boolean]                                     |
| -r, --range  | Range of versions in a format like X.Y.Z ~ A.B.C | [string] [required]                           |
| -o, --output | Output path                                      | [string] [default: "console"]                 |
| -i, --input  | Input CHANGELOG for explore diffs                | [string] [default:process.pwd()/CHANGELOG.md] |
| --help       | Show help                                        | [boolean]                                     |

### Init

Creates a new empty CHANGELOG.md file. 

```bash
changelogger init
```

| Argument     | Description          | Value                                         |
| ------------ | -------------------- | --------------------------------------------- |
| --version    | Show version number  | [boolean]                                     |
| -o, --output | Ouput CHANGELOG file | [string] [default:process.pwd()/CHANGELOG.md] |
| --help       | Show help            | [boolean]                                     |

## Task file format

For the `generate` command you must provide a Markdown file for each of yours task completed on the current branch. Each file:

- Should be named with the code of the task
- Should be splitted in sections with these titles:
  - If anything changed:
    - `## Change[d]`
    - `## Edit[ed]`
    - `## Update[d]`
  - If anything was fixed/hotfixed:
    - `## [hot]Fix[ed]`
  - If anything was added:
    - `## Add[ed]`
    - `## Create[d]`
  - If anything was removed:
    - `## Remove[d]`
    - `## Cancel[led]`
  - If anything was refactored
    - `## Refactor[ed]`

> The `[notation]` used here indicates optional group of characters inside the section title. Each possible variation will be standardised to the form: Changed, Added, Removed, Fixed

- Each section should list each change prepended with `-`.
  - If anything in your list is a breaking change you can prepend your list with `[breaking]`


> 🔥 The CHANGELOG format inspires to [keepachangelog](https://keepachangelog.com/it-IT/1.0.0/)

### Example

```markdown
## Changed
- change 1
- change 2
- [breaking] breaking change 3!

## Fix
- fix 1
- fix 2
```
